<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="fantasykai`blog"><title>Nginx常用指令详解 | 枫哲's文栖小筑</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/latest/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/grids-responsive-min.min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/latest/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement('script');
  hm.src = 'https://hm.baidu.com/hm.js?' + '2bb92548008bd1f1f88213efd40c8dad';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();</script><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/latest/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/latest/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/latest/toastr.min.css"><div class="darkmode-toggle">🌓</div><script>var prefersDarkMode = window.matchMedia('(prefers-color-scheme: dark)');
var toggle = document.querySelector('.darkmode-toggle');
var html = document.querySelector('html');

html.dataset.dark = localStorage.dark || prefersDarkMode.matches;

toggle.addEventListener('click', () => {
localStorage.dark = !(html.dataset.dark == 'true');
html.dataset.dark = localStorage.dark;
});</script><meta name="generator" content="Hexo 6.3.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Nginx常用指令详解</h1><a id="logo" href="/.">枫哲's文栖小筑</a><p class="description">君子终日乾乾，夕惕若厉，无咎</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/tags/"><i class="fa fa-tag"> 标签</i></a><a href="/timeline/"><i class="fa fa-book"> 历史</i></a><a href="/blogroll/"><i class="fa fa-external-link"> 收藏链接</i></a><a href="/2048/"><i class="fa fa-gamepad"> 放松下</i></a><a href="/guestbook/"><i class="fa fa-comments"> 留言</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Nginx常用指令详解</h1><div class="post-meta">2017-08-06<span> | </span><span class="category"><a href="/categories/%E5%AE%B9%E5%99%A8/">容器</a></span></div><a class="disqus-comment-count" href="/2017/08/06/%E6%8A%80%E6%9C%AF%E5%B0%8F%E6%A0%88/%20Nginx%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4%E8%AF%A6%E8%A7%A3/#vcomment"><span class="waline-comment-count" id="/2017/08/06/%E6%8A%80%E6%9C%AF%E5%B0%8F%E6%A0%88/%20Nginx%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4%E8%AF%A6%E8%A7%A3/"></span><span> 条评论</span></a><div class="post-content"><h2 id="Nginx运维常用指令详解"><a href="#Nginx运维常用指令详解" class="headerlink" title="Nginx运维常用指令详解"></a>Nginx运维常用指令详解</h2><h4 id="目录："><a href="#目录：" class="headerlink" title="目录："></a>目录：</h4><ul>
<li><p>一、主配置文件框架解析</p>
</li>
<li><ul>
<li><a href="#main_cfg_para">1、Main配置段常用参数</a></li>
<li><a href="#event_cfg_para">2、event配置段常用参数</a></li>
<li><a href="#http_cfg_para">3、http配置段常用参数</a></li>
<li><a href="#clinet_cfg_para">4、面向客户端请求相关的配置</a></li>
<li><a href="#client_limit">5、对客户端请求进行限制</a></li>
<li><a href="#file_cfg_para">6、文件操作优化相关的配置</a></li>
</ul>
</li>
<li><p><a href="#ngx_http_access_module">二、ngx_http_access_module模块</a></p>
</li>
<li><p><a href="#ngx_http_auth_basic_module">三、ngx_http_auth_basic_module模块</a></p>
</li>
<li><p><a href="#ngx_http_log_module">四、ngx_http_log_module模块</a></p>
</li>
<li><p><a href="#ngx_http_stub_status_module">五、ngx_http_stub_status_module模块</a></p>
</li>
<li><p><a href="#ngx_http_referer_module">六、ngx_http_referer_module模块</a></p>
</li>
<li><p><a href="#ngx_http_ssl_module">七、ngx_http_ssl_module模块</a></p>
</li>
<li><p><a href="#ngx_http_rewrite_module">八、ngx_http_rewrite_module模块</a></p>
</li>
<li><p><a href="#ngx_http_gzip_module">九、ngx_http_gzip_module模块</a></p>
</li>
<li><p><a href="#ngx_http_fastcgi_module">十、ngx_http_fastcgi_module模块</a></p>
</li>
<li><p><a href="#ngx_http_proxy_module">十一、ngx_http_proxy_module模块</a></p>
</li>
<li><p><a href="#ngx_http_headers_module">十二、ngx_http_headers_module模块</a></p>
</li>
<li><p><a href="#ngx_http_upstream_module">十三、ngx_http_upstream_module模块</a></p>
</li>
</ul>
<hr>
<h1 id="nginx常用配置详解"><a href="#nginx常用配置详解" class="headerlink" title="nginx常用配置详解"></a>nginx常用配置详解</h1><h2 id="一、主配置文件框架解析"><a href="#一、主配置文件框架解析" class="headerlink" title="一、主配置文件框架解析"></a>一、主配置文件框架解析</h2><h4 id="1、Main配置段常用参数"><a href="#1、Main配置段常用参数" class="headerlink" title="1、Main配置段常用参数"></a><span id="main_cfg_para">1、Main配置段常用参数</span></h4><h6 id="1-正常运行必备的配置指令"><a href="#1-正常运行必备的配置指令" class="headerlink" title="(1) 正常运行必备的配置指令"></a>(1) 正常运行必备的配置指令</h6><ul>
<li><p><code>uesr USERNAME [GROUPNAME];</code></p>
</li>
<li><ul>
<li>指定用于运行worker进程的用户和组,默认是nginx用户,nginx组</li>
</ul>
</li>
<li><p><code>pid /path/to/pid_file;</code></p>
</li>
<li><ul>
<li>指定nginx进程的PID文件路径, 默认为:pid &#x2F;var&#x2F;runl&#x2F;nginx&#x2F;nginx.pid</li>
</ul>
</li>
<li><p><code>worker_rlimit_nofile #;</code></p>
</li>
<li><ul>
<li>指定每个worker进程能打开的最大文件描述符数量(nofile: number of file)</li>
</ul>
</li>
<li><p><code>worker_rlimit_sigpending #;</code></p>
</li>
<li><ul>
<li>指定每个用户能够发往worker进程的信号的最大数量</li>
</ul>
</li>
</ul>
<h6 id="2-性能优化相关的配置"><a href="#2-性能优化相关的配置" class="headerlink" title="(2) 性能优化相关的配置"></a>(2) 性能优化相关的配置</h6><ul>
<li><p><code>woker_processes #;</code></p>
</li>
<li><ul>
<li>worker进程的个数,通常应该为物理CPU核心数量减1或者减2,worker_processes auto;可以根据物理CPU自动设定. worker不使用进程或线程处理请求, 而是直接将worker绑定到CPU上, 这样就没有进程切换的说法了.</li>
</ul>
</li>
<li><p><code>worker_cpu_affinity CPUMASK CPUMASK...;</code></p>
</li>
<li><ul>
<li>将worker进程与指定的CPU进行绑定,这种绑定不能隔离CPU,CPU还可能会响应其它进程请求.</li>
</ul>
</li>
<li><p><code>worker_priority NICE;</code></p>
</li>
<li><ul>
<li>[-20,19],worker进程的优先级, 默认为0</li>
</ul>
</li>
</ul>
<h6 id="3-调试定位问题的配置"><a href="#3-调试定位问题的配置" class="headerlink" title="(3)调试定位问题的配置"></a>(3)调试定位问题的配置</h6><ul>
<li><p><code>daemon [off|on];</code></p>
</li>
<li><ul>
<li>是否以守护进程方式启动nginx</li>
</ul>
</li>
<li><p><code>master_process [on | off];</code></p>
</li>
<li><ul>
<li>是否以master&#x2F;worker模型运行nginx,off后,只单个进程启动Nignx.</li>
</ul>
</li>
<li><p><code>error_log /path/to/error_log Level;</code></p>
</li>
<li><ul>
<li>错误日志文件及级别, 出于调试的需要,可以设定为debug,但在debug级别在编译时使用—with-debug选项时才有效</li>
</ul>
</li>
</ul>
<h4 id="2、event配置段常用参数"><a href="#2、event配置段常用参数" class="headerlink" title="2、event配置段常用参数"></a><span id="event_cfg_para">2、event配置段常用参数</span></h4><ul>
<li><p><code>worker_connections #;</code></p>
</li>
<li><ul>
<li>每个worker进程所能够响应的最大并发请求数量, 请求的最大上限为:worker_processes * worker_connections</li>
</ul>
</li>
<li><p><code>use [epoll | rgsig | select | poll]]</code></p>
</li>
<li><ul>
<li>定义使用的事件模型, 建议让nginx自动选择</li>
</ul>
</li>
<li><p><code>accept_mutex [on | off];</code></p>
</li>
<li><ul>
<li>定义内部调用请求至worker时请求的互斥锁文件(各worker接收用户的请求的负载均衡锁),on:能够让多个worker轮流地,序列化的响应新请求</li>
</ul>
</li>
<li><p><code>lockfile /path/to/lockfile</code></p>
</li>
<li><ul>
<li>锁文件定义位置</li>
</ul>
</li>
</ul>
<h4 id="3、http配置段常用参数"><a href="#3、http配置段常用参数" class="headerlink" title="3、http配置段常用参数"></a><span id="http_cfg_para">3、http配置段常用参数</span></h4><ul>
<li><p><code>server &#123;&#125;</code></p>
</li>
<li><ul>
<li>定义一个虚拟主机,server可以出现一次或多次</li>
</ul>
</li>
<li><p><code>listen address [:port] [default_server] [[ssl] [http2 | spdy]]</code></p>
</li>
<li><p><code>listen port [default_server] [ssl] [http2 | spdy]</code></p>
</li>
<li><ul>
<li>default_server:设置默认虚拟主机, 当用户使用IP地址访问时,就返回default_server的虚拟主机, 如果未定义default_server时,第一个虚拟主机将做为默认的主机</li>
<li>ssl : 用于限制只能通过SSL连接提供服务,不是以端口确认其协议的, 故需要启用ssl,需要在监听的端口后面, 添加ssl选项</li>
<li>spdy : spdy protocol(google研发的http协议,比http&#x2F;1.1性能要好, 全称为speedy),在编译时编译了spdy模块的情况下,用于支持spdy协议</li>
<li>http2 : http version2,在编译时需要开启http2协议支持</li>
</ul>
</li>
<li><p><code>server_name NAME [....];</code> : 指明主机名称</p>
</li>
<li><ul>
<li><p>(1) 先做精确匹配,例如:<a target="_blank" rel="noopener" href="http://www.zhenping.me/">www.zhenping.me</a></p>
</li>
<li><p>(2) 左侧通配符,例如:*.zhenping.me</p>
</li>
<li><p>(3) 右侧通配符,例如:<a target="_blank" rel="noopener" href="http://www.zhenping/">www.zhenping</a>.*</p>
</li>
<li><p>(4) 正则表达式匹配,例如:~^.*.zhenping.me$</p>
</li>
<li><p>default_server</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx默认工作法则: 先将域的匹配规则,先做hash计算,把计算的结果放置进内存,下次访问请求过来时, 直接做对比</span><br></pre></td></tr></table></figure>
</li>
<li><p>servername后可跟一个或多个主机名, 名称还可以使用通配符和正则表达式(~),域名匹配顺序</p>
</li>
</ul>
</li>
<li><p><code>tcp_nodelay [on | off];</code></p>
</li>
<li><ul>
<li>对keepalive模式下的连接是否使用tcp_nodelay选项,默认关闭.其功能为:把多个小报文合并为一个报文,一起发送. 此机制可以提高带宽利用率,将发往同一个主机很小的TCP报文合并成一个,实际生产对于用户请求即使浪费带宽也不能合并请求</li>
</ul>
</li>
<li><p><code>tcp_nopush [on | off];</code></p>
</li>
<li><ul>
<li>是否启用tcp_nopush(FreeBSD)或tcp_cork(linux)选项,仅在sendfile为on时有用, 其功能:尝试将多个报文首部压缩成一个发送, 默认为off,不启用该功能</li>
</ul>
</li>
<li><p><code>sendfile [on | off];</code></p>
</li>
<li><ul>
<li>是否启用sendfile功能,静态文件直接在内核中封装响应,而不是从内核空间到用户空间封装后,再发往内核空间.</li>
</ul>
</li>
<li><p><code>roo /PATH/TO/Directory;</code></p>
</li>
<li><ul>
<li>设置web资源的路径映射,用于指明请求的URL所对应的文件的目录路径,可用于server或location中.</li>
</ul>
</li>
<li><p><code>location [ = | ~ | ~* | ^~ ] url &#123; ...&#125;</code></p>
</li>
<li><p><code>location @name &#123;...&#125;</code></p>
</li>
<li><ul>
<li><code>=</code> : URI的精确匹配</li>
<li><code>~</code> : 做正则表达式匹配,区分字符大小写</li>
<li><code>~*</code> : 做正则表达式匹配,不区分字符大小写</li>
<li><code>^~</code> : URI的左半部分匹配,不区分字符大小写</li>
<li>允许根据用户请求的URI来匹配定义的各location,匹配到时, 此请求将被相应的location块中的配置所处理, 简言之:用于为需要用到专用配置的uri提供特定配置.</li>
<li>当匹配多次时,其匹配优先级为:精确匹配&#x3D;,^<del>,</del>或~*,不带符号的URL, 如果优先级都一样, 就匹配最精确的规则</li>
</ul>
</li>
<li><p><code>alias</code></p>
</li>
<li><ul>
<li>只能用于location配置段,用于定义路径别名</li>
</ul>
</li>
<li><p><code>index</code></p>
</li>
<li><ul>
<li>设置默认主页(nginx_http_index_module模块引入), 可以带上变量,如$geo根据不同IP地址来设置不同的语言主页,应用上下文为:http,server,location</li>
</ul>
</li>
<li><p><code>error_page code ...[=[response]] uri;</code></p>
</li>
<li><ul>
<li>自定义错误页面,根据http状态码重写向错误页面</li>
</ul>
</li>
<li><p><code>try_files file... uri;</code></p>
</li>
<li><p><code>try_files file... =code;</code></p>
</li>
<li><ul>
<li>可用于server,location中, 以指定的顺序检查文件的存在性响应</li>
<li>尝试查找第1至第N-1个文件,第一个即为返回给请求者的资源,若1至N-1文件都不存在, 则跳转至最后一个uri(必须 不能匹配至当前location,而应该匹配至其它location,否则会导致死循环)</li>
</ul>
</li>
</ul>
<h4 id="4、面向客户端请求相关的配置"><a href="#4、面向客户端请求相关的配置" class="headerlink" title="4、面向客户端请求相关的配置"></a><span id="clinet_cfg_para">4、面向客户端请求相关的配置</span></h4><ul>
<li><p><code>keepalive_disable none | browser;</code></p>
</li>
<li><ul>
<li>禁止那些浏览器使用keepalive功能,如: keepalive_disable msie6</li>
</ul>
</li>
<li><p><code>keepalive_timeout #s;</code></p>
</li>
<li><ul>
<li>设定keepalive连接的超时时长,0表示禁止长连接,默认启用为75s</li>
</ul>
</li>
<li><p><code>keepalive_requests #;</code></p>
</li>
<li><ul>
<li>在keepalive连接上所允许请求的最大资源数量,默认为100;</li>
</ul>
</li>
<li><p><code>send_timout #;</code></p>
</li>
<li><ul>
<li>发送响应报文的超时时长,默认为60s;</li>
</ul>
</li>
<li><p><code>client_body_buffer_size SIZE(8k | 16k);</code></p>
</li>
<li><ul>
<li>接收客户请求报文body的缓冲区大小, 默认为16k(64位系统,32位系统为8K),超出指定大小时将被移存于磁盘上.</li>
</ul>
</li>
<li><p><code>client_body_temp_path [Level1 [level2 [level3]]]</code></p>
</li>
<li><ul>
<li>设定用于存储客户端请求body的临时存储路径及子目录结构和数量</li>
</ul>
</li>
</ul>
<h4 id="5、对客户端请求进行限制"><a href="#5、对客户端请求进行限制" class="headerlink" title="5、对客户端请求进行限制"></a><span id="client_limit">5、对客户端请求进行限制</span></h4><ul>
<li><p><code>limit_except METHOD &#123;...&#125;;</code></p>
</li>
<li><ul>
<li>对指定范围之外的其它方法进行访问控制,应用于location上下文</li>
</ul>
</li>
<li><p><code>limit_rate SPEED;</code></p>
</li>
<li><ul>
<li>限制客户端每秒种所能够传输的字节数, 默认为0,表示不限制,应用于http,server,location,if in location上下文中</li>
</ul>
</li>
<li><p><code>limit_rate_after SIZE;</code></p>
</li>
<li><ul>
<li>超出SIZE的值, 就限制速度,应用于http,server,location,if in locataion上下文中</li>
</ul>
</li>
</ul>
<h4 id="6、文件操作优化相关的配置"><a href="#6、文件操作优化相关的配置" class="headerlink" title="6、文件操作优化相关的配置"></a><span id="file_cfg_para">6、文件操作优化相关的配置</span></h4><ul>
<li><p><code>aio on | off;</code></p>
</li>
<li><ul>
<li>是否启用异步IO模式, 应用于http, server,location上下文中</li>
</ul>
</li>
<li><p><code>directio size | off;</code></p>
</li>
<li><ul>
<li>是否启用直接IO操作, 不在内存中缓冲, 直接从硬盘加载使用(当大于指定的size),应用于http,server,location</li>
</ul>
</li>
<li><p><code>open_file_cache off | max=N [inactive=time];</code></p>
</li>
<li><ul>
<li>(1) 文件描述符</li>
<li>(2) 文件大小</li>
<li>(3) 最近一次的修改时间</li>
<li>(4) 打开的目录的结构</li>
<li>(5) 没有找到或者没有权限操作的文件的相关信息</li>
<li>对打开的文件进行缓存 ,nginx可以缓存以下三种信息</li>
<li>max&#x3D;N : 可缓存的最大条目上限,一旦达到上限, 则会使用LRU算法从缓存中删除最近最少使用的缓存项</li>
<li>inactive&#x3D;time : 在此处指定的时长内没有被访问过的缓存项识别为非活动缓存项, 因此直接删除</li>
</ul>
</li>
<li><p><code>open_file_cache errors on|off;</code></p>
</li>
<li><ul>
<li>是否缓存找不到其路径的文件,或没有权限访问的文件相关信息</li>
</ul>
</li>
<li><p><code>open_file_cache_valid time;</code>    </p>
</li>
<li><ul>
<li>每隔多久检查一次缓存中缓存项的有效性,默认为60秒</li>
</ul>
</li>
<li><p><code>open_file_cache_min_uses number;</code></p>
</li>
<li><ul>
<li>缓存项在非活动其限内最少应该被访问的次数</li>
</ul>
</li>
</ul>
<h2 id="二、ngx-http-access-module模块"><a href="#二、ngx-http-access-module模块" class="headerlink" title="二、ngx_http_access_module模块"></a><span id="ngx_http_access_module">二、ngx_http_access_module模块</span></h2><h4 id="1、基于用户IP的权限控制"><a href="#1、基于用户IP的权限控制" class="headerlink" title="1、基于用户IP的权限控制"></a>1、基于用户IP的权限控制</h4><ul>
<li><p><code>allow address | CIDR | unix: | all;</code> 允许</p>
</li>
<li><p><code>deny address | CIDR | unix: | all;</code> 拒绝</p>
</li>
<li><ul>
<li><p>应用上下文件:http,server,location,limit_except</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">示例:</span><br><span class="line">  location / &#123;</span><br><span class="line">      deny 192.168.1.1;</span><br><span class="line">      allow 192.16.1.0/24;</span><br><span class="line">      allow 10.1.1.0/16;</span><br><span class="line">      allow 2001:0db8::32;</span><br><span class="line">      deny all;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h2 id="三、ngx-http-auth-basic-module模块"><a href="#三、ngx-http-auth-basic-module模块" class="headerlink" title="三、ngx_http_auth_basic_module模块"></a><span id="ngx_http_auth_basic_module">三、ngx_http_auth_basic_module模块</span></h2><h4 id="1、基于Basic认证的权限控制"><a href="#1、基于Basic认证的权限控制" class="headerlink" title="1、基于Basic认证的权限控制"></a>1、基于Basic认证的权限控制</h4><ul>
<li><p><code>auth_basic string | off;</code></p>
</li>
<li><ul>
<li>用户定义认证的名称,string为所给定字符,其作用在于认证时显示的提示信息</li>
</ul>
</li>
<li><p><code>auth_basic_user_file FILE;</code></p>
</li>
<li><ul>
<li>实现用户认证的用户及帐号文件,文件格式如下(需手动创建):</li>
<li>密码可以使用httpd程序自带的工具htpasswd创建</li>
</ul>
</li>
</ul>
<h2 id="四、ngx-http-log-module模块的配置-访问日志"><a href="#四、ngx-http-log-module模块的配置-访问日志" class="headerlink" title="四、ngx_http_log_module模块的配置(访问日志)"></a><span id="ngx_http_log_module">四、ngx_http_log_module模块的配置(访问日志)</span></h2><h4 id="1、访问日志控制"><a href="#1、访问日志控制" class="headerlink" title="1、访问日志控制"></a>1、访问日志控制</h4><ul>
<li><p><code>log_format name string....;</code></p>
</li>
<li><ul>
<li>定义日志格式及其名称,日志格式一般通过调用内置变量来定义,默认格式为combined</li>
</ul>
</li>
<li><p><code>access_log path [format[buffer=size [flush=time]]];</code></p>
</li>
<li><p><code>access_log off</code></p>
</li>
<li><ul>
<li>定义日志文件路径,格式名称以及缓存大小和刷写时间间隔,建议定义缓冲以提升性能</li>
</ul>
</li>
<li><p><code>open_log_file_cache max=N [inactive=time] [min_uses] [valid=time];</code></p>
</li>
<li><p><code>open_log_file_cache off;</code></p>
</li>
</ul>
<h2 id="五、ngx-http-stub-status-module模块"><a href="#五、ngx-http-stub-status-module模块" class="headerlink" title="五、ngx_http_stub_status_module模块"></a><span id="ngx_http_stub_status_module">五、ngx_http_stub_status_module模块</span></h2><h4 id="1、nginx自身status的信息配置"><a href="#1、nginx自身status的信息配置" class="headerlink" title="1、nginx自身status的信息配置"></a>1、nginx自身status的信息配置</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Active connections: 1 </span><br><span class="line">server accepts handled requests</span><br><span class="line"> 2 2 18 </span><br><span class="line">Reading: 0 Writing: 1 Waiting: 0</span><br></pre></td></tr></table></figure>

<h6 id="各参数说明"><a href="#各参数说明" class="headerlink" title="各参数说明"></a>各参数说明</h6><ul>
<li>active connections : 当前活动的客户端连接数,包括等待的.</li>
<li>accepts : 已接受的客户端的连接总数量</li>
<li>handled : 已处理完成的客户端连接请求总数量</li>
<li>requests : 客户端总的请求数</li>
<li>reading : 当前正在读取的客户端请求报文首部信息的数量</li>
<li>writing : 当前正在向客户端发送响应报文的连接数量</li>
<li>wating : 等待其发出请求的空闲连接数量</li>
</ul>
<h2 id="六、ngx-http-referer-module模块"><a href="#六、ngx-http-referer-module模块" class="headerlink" title="六、ngx_http_referer_module模块"></a><span id="ngx_http_referer_module">六、ngx_http_referer_module模块</span></h2><blockquote>
<p>基于请求报文中的referer首部的值, 做访问控制 ,可以防止盗链,其只应用于server,location上下文</p>
</blockquote>
<ul>
<li><p><code>referer_hash_bucket_size SIZE;</code></p>
</li>
<li><ul>
<li>可以放多个缓存我要上,默认是64</li>
</ul>
</li>
<li><p><code>referer_hash_max_size SIZE;</code></p>
</li>
<li><ul>
<li>默认2048</li>
</ul>
</li>
<li><p><code>valid_referers none|blocked|server_names|string...;</code></p>
</li>
<li><ul>
<li>none : 请求的报文不存在referer首部</li>
<li>blocked : 请求报文中存在referer首部,但其没有有效值,或其值非以<a href="">http:&#x2F;&#x2F;或https开头</a></li>
<li>server_names :其值为一个主机名</li>
<li>arbitrary string : 直接字符串,可以使用*号匹配</li>
<li>rugular expression : 以~起始的正则表达式</li>
</ul>
</li>
</ul>
<h2 id="七、ngx-http-ssl-module模块"><a href="#七、ngx-http-ssl-module模块" class="headerlink" title="七、ngx_http_ssl_module模块"></a><span id="ngx_http_ssl_module">七、ngx_http_ssl_module模块</span></h2><ul>
<li><p><code>listen 443 ssl;</code></p>
</li>
<li><ul>
<li>在指定端口上启用必须ssl连接</li>
</ul>
</li>
<li><p><code>server_name www.zhenping.me;</code></p>
</li>
<li><ul>
<li>ssl主机的FQDN名称</li>
</ul>
</li>
<li><p><code>ssl_certificate cert.pem;</code></p>
</li>
<li><ul>
<li>ssl的公钥</li>
</ul>
</li>
<li><p><code>ssl_certificate_key cert.key;</code></p>
</li>
<li><ul>
<li>ssl的私钥</li>
</ul>
</li>
<li><p><code>ssl_session_cache off | none | [builtin[:size]] [shard:name:size];</code></p>
</li>
<li><ul>
<li>默认使用shared模式</li>
<li>off : 禁止缓存 ,关闭缓存,不支持缓存功能</li>
<li>none :禁止缓存 ,不响应缓存</li>
<li>builtin : 使用openssl内置的ssl会话缓存 ,此机制为各worker私有</li>
<li>shared: 在各worker之间使用一个共享的缓存,name:独有名称,size:缓存空间大小, 默认为1M,可以调到10M</li>
</ul>
</li>
<li><p><code>ssl_session_timeout 5m;</code></p>
</li>
<li><ul>
<li>ssl会议超时时长,即ssl session cache中的缓存有效时长,默认为5m</li>
</ul>
</li>
<li><p><code>ssl_prefer_server_ciphers on;</code></p>
</li>
<li><ul>
<li>优先使用服务端选择的加密算法</li>
</ul>
</li>
<li><p><code>ssl on | off;</code></p>
</li>
<li><ul>
<li>启用或关闭ssl,若不在listen处定义，也可以在server{ }中定义ssl on; 来启用https服务</li>
</ul>
</li>
<li><p><code>ssl_buffer_size SIZE;</code></p>
</li>
<li><ul>
<li>ssl缓冲大小</li>
</ul>
</li>
<li><p><code>ssl_ciphers CIPHERS;</code></p>
</li>
<li><ul>
<li>指明由nginx使用的加密算法,可以是openssl库所支持各加密套件</li>
</ul>
</li>
<li><p><code>ssl_client_certificate file;</code></p>
</li>
<li><ul>
<li>需要验证客户端证书</li>
</ul>
</li>
<li><p><code>ssl_crl FILE;</code></p>
</li>
<li><ul>
<li>证书吊销列表</li>
</ul>
</li>
<li><p><code>ssl_protocols [sslv2][sslv3][tlsv1][tlsv1.1][tlsv1.2];</code></p>
</li>
<li><ul>
<li>使用哪些协议版本, 默认为TLSv1,TLSv1.1,TLSv1.2</li>
</ul>
</li>
<li><p><code>ssl_trusted_certificate FILE;</code></p>
</li>
<li><ul>
<li>信任的根证书</li>
</ul>
</li>
<li><p><code>ssl_session_ticket_key FILE;</code></p>
</li>
</ul>
<h2 id="八、ngx-http-rewrite-module模块"><a href="#八、ngx-http-rewrite-module模块" class="headerlink" title="八、ngx_http_rewrite_module模块"></a><span id="ngx_http_rewrite_module">八、ngx_http_rewrite_module模块</span></h2><blockquote>
<p>将请求的url基于正则表达式进行重写(URL重定向),在如下情况下可以使用:http转换成httpd服务(http→https),域名转换domain.tld →domain2.tld, URL转换uri → uri2,实现SEO搜索引擎优化效果…. 将用户请求的URL基于正则表达式进行重写</p>
</blockquote>
<ul>
<li><p><code>rewrite regex replacement [flag];</code></p>
</li>
<li><ul>
<li>last : 重写完成之后停止对当前uri的进一步处理,改为对新uri的新一轮处理(对URI的重写规则进行匹配,当检查到第一条匹配到的时候,进行重写.然后返回到重写规则的第一条位置进行重新匹配,如果有匹配到的再进行重写,默认只能10次匹配). 此过程用户端感受不到.</li>
<li>break : 对URI的重写规则进行匹配,只要匹配到就重写,不再进行再次匹配,此过程用户端感受不到.</li>
<li>redirect : 重写完成之后返回客户端一个临时重定向,由客户端对新的URI重新发起请求, 即302的状态码</li>
<li>permanent : 重写完成之后,会返回客户端一个永久的重写向,由客户端对新的URI重新发起请求,即301的状态码</li>
<li>PCRE正则表达式元字符</li>
<li>字符: .,[],[^]</li>
<li>次数: *,+,?,{m},{m,}{m,n}</li>
<li>位置锚定: ^,$</li>
<li>或者: |</li>
<li>分组: (), 后向引用: 2,…..</li>
<li>应用于server,location,if上下文</li>
<li>regex : 基于perl的正则表达式,用于匹配用户请求的URL;</li>
<li>replacement : 重写为的结果</li>
<li>flag:标志位</li>
</ul>
</li>
<li><p><code>if(condition) &#123;...&#125;</code> :条件判断,引用新的配置上下文</p>
</li>
<li><ul>
<li>-f,!-f : 是否存在且为普通文件</li>
<li>-d,!-d : 是否存在且为目录</li>
<li>-e,!-e : 是否存在</li>
<li>-x,!-x : 是否存在且可执行</li>
<li>&#x3D;&#x3D;, !&#x3D;</li>
<li>~ : 模式匹配,区分字符大小写</li>
<li>~* : 模式匹配,不区分字符大小写</li>
<li>!~ : 模式不匹配, 区分字符大小写</li>
<li>!~* : 模式不匹配,不区分字符大小写</li>
<li>condition比较表达式:</li>
<li>文件及目录判断:</li>
</ul>
</li>
<li><p><code>return</code> : 立即停止对请求的URI的处理,并返回指定的状态码</p>
</li>
<li><ul>
<li>returncode [text];</li>
<li>returncode URL</li>
<li>return URL;</li>
</ul>
</li>
<li><p><code>set</code> : 设定变量值,或者自定义变量</p>
</li>
<li><ul>
<li>set $variable value;</li>
</ul>
</li>
<li><p><code>rewrite_log on | off;</code></p>
</li>
<li><ul>
<li>是否将重写日志记录errorlog中,默认为关闭(调试方法:错误日志debug,并开启rewrite_log)</li>
</ul>
</li>
</ul>
<h2 id="九、ngx-http-gzip-module模块"><a href="#九、ngx-http-gzip-module模块" class="headerlink" title="九、ngx_http_gzip_module模块"></a><span id="ngx_http_gzip_module">九、ngx_http_gzip_module模块</span></h2><ul>
<li><p><code>gzip on | off;</code></p>
</li>
<li><ul>
<li>启用或禁用gzip压缩响应报文</li>
</ul>
</li>
<li><p><code>gzip_buffers number size;</code></p>
</li>
<li><ul>
<li>default 32位系统4k,64位系统8k</li>
</ul>
</li>
<li><p><code>gzip_comp_level LEVEL;</code></p>
</li>
<li><ul>
<li>压缩比,1-9,默认为1</li>
</ul>
</li>
<li><p><code>gzip_disable regex ...;</code></p>
</li>
<li><ul>
<li>regex是为用于匹配客户端响应器类型的正则表达式,表示对何种浏览器禁止使用压缩功能</li>
</ul>
</li>
<li><p><code>gzip_min_length LENGTH;</code></p>
</li>
<li><ul>
<li>触发压缩功能的响应报文的最小长度</li>
</ul>
</li>
<li><p><code>gzip_http_version 1.0 | 1.1;</code></p>
</li>
<li><ul>
<li>设定启用压缩功能的最小版本</li>
</ul>
</li>
<li><p><code>gzip_proxied off | expired | no-cache | no-store | private | no_last_modified | no_etg | auth | any ...;</code></p>
</li>
<li><ul>
<li>定义对客户端请求的具有何种请求属性的资源启用压缩功能,如expired表示:对由于使用expire首部而无法缓存的对象启用压缩功能</li>
</ul>
</li>
<li><p><code>gzip_types mime.type;</code></p>
</li>
<li><ul>
<li>指明对那些类型的资源进行压缩</li>
</ul>
</li>
</ul>
<h2 id="十、ngx-http-fastcgi-module模块"><a href="#十、ngx-http-fastcgi-module模块" class="headerlink" title="十、ngx_http_fastcgi_module模块"></a><span id="ngx_http_fastcgi_module">十、ngx_http_fastcgi_module模块</span></h2><blockquote>
<p>fastcgi_module只能对后端的一台应用服务器进行反代,如果需要给多台应用服务器进行反代实现负载,需借助upstream模块定义一组服务器,由fastcgi功能引用来完成, lnmp的架构中, ningx只支持fastcgi的模式连接后端php服务器,不能将应用服务运行为一个子模块的方式.nginx不支持动态加载模块机制(DSO),所以需要编译php工作为fpm机制时,将ngnx_http_fastcgi_module编译到nginx程序中,在php编译时需使用 —enable-fpm,将Php设置为fpm模式.</p>
</blockquote>
<p>LNMP架构仅支持一种nginx+php的结合方式,实现方式如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    ...</span><br><span class="line">    location ~* \.php$ &#123; </span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1、fastcgi模块指令"><a href="#1、fastcgi模块指令" class="headerlink" title="1、fastcgi模块指令"></a>1、fastcgi模块指令</h4><ul>
<li><p><code>fastcgi_pass address;</code></p>
</li>
<li><ul>
<li>address为fastcgi server监听的地址,如: fastcgi_pass localhost:9000;</li>
</ul>
</li>
<li><p><code>fastcgi_index NAME;</code></p>
</li>
<li><ul>
<li>定义fastcgi应用的默认主机,如: fastcgi_index index.php;</li>
</ul>
</li>
<li><p><code>fastcgi_param PARAMETER VALUE[if_not_empty];</code></p>
</li>
<li><ul>
<li>用户定义客户端请求的哪些属性传递给后端fastcti_server</li>
</ul>
</li>
<li><p><code>fastcgi_pass_header field;</code></p>
</li>
<li><ul>
<li>允许把fastcgi的响应首部直接发送给客户端</li>
</ul>
</li>
<li><p><code>fastcgi_cache_path path [levels=levels][use_temp_path=on|off] keys_zone=name:size [inactive=time][max_szie=size];</code></p>
</li>
<li><ul>
<li>缓存对象名字都以16进制进行编码,故一级目录一般为16个或者256个</li>
<li>元数据存在内存中,即为keys_zone</li>
<li>数据存在硬盘,即为path</li>
<li>用于定义缓存,缓存 空间等,可应用于http上下文,需要运行php的用户对path有写权限.</li>
<li>缓存机制:</li>
<li>levels&#x3D;#[:#[:#]] : 表示可以使用三级目录进行保存</li>
<li>keys_zone&#x3D;name:size : name名称要全局唯一,cache的标识符</li>
<li>inactive&#x3D;time : 缓存的非活动时间,缓存的访问次数在指定的time内比较少,就需要清理出去</li>
<li>max-size : 缓存空间上限,指磁盘的缓存空间上限</li>
</ul>
</li>
<li><p><code>fastcgi_cache zone | off;</code></p>
</li>
<li><ul>
<li>调用定义过的缓存,zone即为通过fastcgi_cache_path定义缓存时其keys_zone参数中的name</li>
</ul>
</li>
<li><p><code>fastcgi_cache_key string;</code></p>
</li>
<li><ul>
<li>定义那些键需要进行缓存,如用户访问的URI,如:fastcgi_cache_key $request_uri;</li>
</ul>
</li>
<li><p><code>fastcgi_cache_methods GET|HEAD|POST...;</code></p>
</li>
<li><ul>
<li>为何种请求方法对应的请求进行缓存,默认为get和head</li>
</ul>
</li>
<li><p><code>fastcgi_cache_min_uses number;</code></p>
</li>
<li><ul>
<li>缓存项的最少使用次数,默认为1次</li>
</ul>
</li>
<li><p><code>fastcgi_cache_revalidate on |off;</code></p>
</li>
<li><p><code>fastcgi_cache_use_stale error | timeout | invalid_header | updating | http_500 | http_503 | http_403 | http_404 | off;</code></p>
</li>
<li><ul>
<li>是否可使用stale缓存项(不新鲜)响应用户请求,默认是off</li>
</ul>
</li>
<li><p><code>fastcgi_cache_valid [code...] time;</code></p>
</li>
<li><ul>
<li>对不同响应码的响应设定可缓时长</li>
<li>缓存的设定及调用</li>
</ul>
</li>
</ul>
<h2 id="十一、ngx-http-proxy-module模块"><a href="#十一、ngx-http-proxy-module模块" class="headerlink" title="十一、ngx_http_proxy_module模块"></a><span id="ngx_http_proxy_module">十一、ngx_http_proxy_module模块</span></h2><p>反向代理(reverse proxy)方式是指以代理服务器来接受internet上的连接请求,然后将请求转发给内部网络上的服务器, 并将从服务器上得到的结果返回给internet上请求连接的客户端,此时站在服务器角度来看,代理服务器对外就表现为一个反向代理服务器,对反向代理服务器的攻击并不会使得后端内网web服务器上网页信息破坏,增强了web服务器的安全性</p>
<ul>
<li><p><code>proxy_pass URL;</code></p>
</li>
<li><ul>
<li>应用上下文:Location,if in location, limit_except</li>
<li>如果location URI时使用正则表达模式匹配时, 其proxy_pass后面的路径一定不能带URI地址</li>
<li>如果location 中有rewrite重写,在proxy_pass后面的连接地址一定不能带URI地址, 那怕有&#x2F;也不可以</li>
</ul>
</li>
<li><p><code>proxy_pass_header field;</code></p>
</li>
<li><ul>
<li>传递首部给客户端</li>
</ul>
</li>
<li><p><code>proxy_hide_header field;</code></p>
</li>
<li><ul>
<li>有意隐藏首部</li>
</ul>
</li>
<li><p><code>proxy_set_header field value;</code></p>
</li>
<li><ul>
<li>proxy_set_header HOST $http_host</li>
<li>proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</li>
<li>request_host传递给host变量,再由代理服务器发起请求的时候,加入host首部(有的情况下代理服务器与backend服务器连接使用的IP地址, 这种传递host参数的情况下,代理发起的访问,都会转为默认的虚拟主机)</li>
<li>将客户端的真实IP地址赋值给X-Forwarded-For变量,代理请求的时候,将发送给后端的backend server.如果中间有多层代理 , 每经过一层代理时,代理服务器都会将在后面增加自己的IP地址,并以分号分隔开来</li>
<li>用于proxy_server向backend_server发请求报文时,将某请求首部重新赋值,或在原有值后面添加一个新的值</li>
</ul>
</li>
<li><p><code>proxy_cache_path path [levels=levels][use_temp_path=on|off] keys_zone=name:size [inactive=time][max_size=size];</code></p>
</li>
<li><ul>
<li>定义缓存,可用于http上下文</li>
</ul>
</li>
<li><p><code>proxy_cache zone | off;</code></p>
</li>
<li><ul>
<li>调用缓存,可用于http,server,location上下文</li>
</ul>
</li>
<li><p><code>proxy_cache_key string;</code></p>
</li>
<li><ul>
<li>$scheme : 所使用的协议</li>
<li>$proxy_host : 请求的那个代理服务器地址</li>
<li>$request_uri : 向那个URI发出的请求,带参数的: <a target="_blank" rel="noopener" href="http://www.zhenping.me/?username=1&amp;userid=1">www.zhenping.me?username=1&amp;userid=1</a></li>
<li>$uri : 向那个URI发出的请求,不带参数</li>
<li>定义缓存键,默认为:proxy_cache_key proxy_host$request_uri;</li>
</ul>
</li>
<li><p>&#96;proxy_cache_valid [code…] time;</p>
</li>
<li><ul>
<li>对不同响应码设定其可缓存时长</li>
</ul>
</li>
<li><p><code>proxy_cache_use_stale error | timeout | invalid_header | updating | http_500 | http_502 |http_503 | http_504 | http_403 | http_404 | off...;</code></p>
</li>
<li><ul>
<li>定义如果后端服务器连接不成功,是否可以使用缓存数据进行响应</li>
</ul>
</li>
<li><p><code>proxy_connect_timeout time;</code></p>
</li>
<li><ul>
<li>定义后端服务器建立连接的超时时长,默认为60s,此值不应该超过75s</li>
</ul>
</li>
<li><p><code>proxy_send_timeout time;</code></p>
</li>
<li><ul>
<li>把请求发送给后端服务器的超时时长,默认为60s</li>
</ul>
</li>
<li><p><code>proxy_read_timeout time;</code></p>
</li>
<li><ul>
<li>等待后端服务器发送响应报文的超时时长,如果有大量的502,就需要考虑这个时长是否过短</li>
</ul>
</li>
</ul>
<h2 id="十二、ngx-http-headers-module模块"><a href="#十二、ngx-http-headers-module模块" class="headerlink" title="十二、ngx_http_headers_module模块"></a><span id="ngx_http_headers_module">十二、ngx_http_headers_module模块</span></h2><ul>
<li><p><code>add_header_name value [always];</code> : (其可操作响应报文首部)</p>
</li>
<li><ul>
<li><p>向响应报文添加自定义首部,并为其赋值,应用上下文为:http,server,location, if in location</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">add_header Via $server_addr;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><code>expires [modified] time;</code></p>
</li>
<li><p><code>expires epoch | max | off;</code></p>
</li>
<li><ul>
<li>默认expires off, 允许或禁止向响应报文的cache-control或expires首部添加新值或修改其值</li>
</ul>
</li>
</ul>
<h2 id="十三、ngx-http-upstream-module模块"><a href="#十三、ngx-http-upstream-module模块" class="headerlink" title="十三、ngx_http_upstream_module模块"></a><span id="ngx_http_upstream_module">十三、ngx_http_upstream_module模块</span></h2><blockquote>
<p>用于将多个服务器定义成服务器组,而由proxy_pass fastcgi_pass等指令引用,应用于http上下文</p>
</blockquote>
<ul>
<li><p><code>upstream name &#123;...&#125;;</code></p>
</li>
<li><ul>
<li>定义一个后端服务器组,name为组名称,仅用于http上下文</li>
</ul>
</li>
<li><p><code>server address [parameters];</code></p>
</li>
<li><ul>
<li>weight&#x3D;number : 定义服务器权重,默认为1</li>
<li>max_fails&#x3D;number : 最大失败连接尝试次数(做健康状态检测),失败连接超时时长由fail_timeout参数指定</li>
<li>fail_timeout&#x3D;number : 等待目标服务器发送响应的时长,总的超时时长</li>
<li>backup : 备用服务器,所有主服务器均故障时,才启用此服务器(即sorry server)</li>
<li>down : 手动标记其不再处理任何用户请求</li>
<li>在upstream中定义一个服务器及相关参数,仅能用于upstream上下文</li>
<li>常用参数:</li>
</ul>
</li>
<li><p><code>ip hash</code></p>
</li>
<li><ul>
<li>源地址hash,把来自同一个IP地址的请求始终发往同一个backend server,除非backend server不可用</li>
</ul>
</li>
<li><p><code>least_conn;</code></p>
</li>
<li><ul>
<li>最少连接,当各server权重不同时,即为加权最少连接</li>
</ul>
</li>
<li><p><code>match name &#123;...&#125;</code></p>
</li>
<li><ul>
<li>status code[code…]; : 期望的响应状态码</li>
<li>header HEADER[oprator value] : 期望存在响应首部,也可对期望的响应首部值基于比较操作符和值进行比较</li>
<li>body : 期望响应报文的主体部分应该有的内容</li>
<li>对backend server做健康状态检测时,定义其结果判断机制,只能用于http上下文</li>
<li>常用参数</li>
</ul>
</li>
<li><p><code>health_check [parameters];</code> (较新版本中的nginx支持)</p>
</li>
<li><ul>
<li>interval&#x3D;time :检测的时间频率,默认为5秒钟</li>
<li>fails&#x3D;number : 判定服务器不可用的失败检测次数,默认为1次</li>
<li>passes&#x3D;number : 判定服务器可用的检测次数,默认为1次</li>
<li>uri&#x3D;URI; : 应用层的检测,做健康状态检测测试的目标URI,默认为”&#x2F;“</li>
<li>match&#x3D;name : 健康状态检测的结果评估调用(match name {…}参数)指定的match配置块</li>
<li>健康状态检测机制,应用上下文:location</li>
<li>常用参数</li>
</ul>
</li>
<li><p><code>hash key[consistent];</code></p>
</li>
<li><ul>
<li>$cookie_name : 将一个用户的请求始终发往同一个backend server,能实现会话绑定的功能,此处的name为cookie中某些参数的名称,此处常用的有:cookie_username.</li>
<li>$request_method</li>
<li>$request_uri : 将对同一个uri的请求始终发往同一个backend server,后端为cache server时特别有用</li>
<li>$uri</li>
<li>应用于upstream中,指明基于hash方式进行调度时,其hash键, hash $remote_addr 相当于ip_hash;</li>
<li>常用的hash key:</li>
</ul>
</li>
</ul>
</div><div class="tags"><a href="/tags/nginx"><i class="fa fa-tag">nginx</i></a></div><div class="post-nav"><a class="pre" href="/2017/08/12/%E6%9D%82%E8%AE%B0/%20Mac%20%E9%94%AE%E7%9B%98%E5%BF%AB%E6%8D%B7%E9%94%AE/">Mac 键盘快捷键</a><a class="next" href="/2017/07/19/%E6%8A%80%E6%9C%AF%E5%B0%8F%E6%A0%88/%20gradle%20%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/">gradle 环境安装配置</a></div><div id="waline"></div><script src="//unpkg.com/@waline/client@v2/dist/waline.js"></script><link rel="stylesheet" type="text/css" href="//unpkg.com/@waline/client@v2/dist/waline.css"><script>let metaInfo = ['nick', 'mail', 'link']
let requiredMeta = 'nick,mail'.split(',').filter(item => {
  return metaInfo.indexOf(item) > -1
})
Waline.init({
  el: '#waline',
  comment: true,
  serverURL: 'https://comment.aimak.cn',
  pageSize: '30',
  wordLimit: '500',
  requiredMeta,
})
</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="author-info"><a class="info-avatar" href="/about/" title="关于"><img src="/img/avatar.png"/></a><p>认真生活.</p><a class="info-icon" href="https://twitter.com/fantasykaicc" title="Twitter" target="_blank" style="margin-inline:5px"> <i class="fa fa-twitter-square" style="margin-inline:5px"></i></a><a class="info-icon" href="mailto:makren@126.com" title="Email" target="_blank" style="margin-inline:5px"> <i class="fa fa-envelope-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://github.com/fantasykai" title="Github" target="_blank" style="margin-inline:5px"> <i class="fa fa-github-square" style="margin-inline:5px"></i></a><a class="info-icon" href="/atom.xml" title="RSS" target="_blank" style="margin-inline:5px"> <i class="fa fa-rss-square" style="margin-inline:5px"></i></a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/AI/">AI</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/docker/">docker</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AE%B9%E5%99%A8/">容器</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a><span class="category-list-count">29</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E5%B0%8F%E6%A0%88/">技术小栈</a><span class="category-list-count">111</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82%E8%AE%B0/">杂记</a><span class="category-list-count">66</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%B5%8B%E8%AF%95/">测试</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%93%E5%AD%98/">缓存</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BD%91%E7%BB%9C/">网络</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AF%AD%E5%BD%95/">语录</a><span class="category-list-count">11</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/Spring/" style="font-size: 15px;">Spring</a> <a href="/tags/thymeleaf/" style="font-size: 15px;">thymeleaf</a> <a href="/tags/spring/" style="font-size: 15px;">spring</a> <a href="/tags/idea/" style="font-size: 15px;">idea</a> <a href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" style="font-size: 15px;">深度学习</a> <a href="/tags/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/" style="font-size: 15px;">知识图谱</a> <a href="/tags/%E6%9E%B6%E6%9E%84/" style="font-size: 15px;">架构</a> <a href="/tags/PMO/" style="font-size: 15px;">PMO</a> <a href="/tags/%E6%8A%80%E6%9C%AF%E5%9B%A2%E9%98%9F/" style="font-size: 15px;">技术团队</a> <a href="/tags/%E5%BC%80%E5%8F%91%E6%95%88%E7%8E%87/" style="font-size: 15px;">开发效率</a> <a href="/tags/%E6%9D%82%E8%AE%B0/" style="font-size: 15px;">杂记</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/js/" style="font-size: 15px;">js</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/mac/" style="font-size: 15px;">mac</a> <a href="/tags/%E6%8A%A5%E5%91%8A%E5%88%86%E4%BA%AB/" style="font-size: 15px;">报告分享</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/Chrome-%E6%95%88%E7%8E%87%E6%8F%92%E4%BB%B6/" style="font-size: 15px;">Chrome 效率插件</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 15px;">工具</a> <a href="/tags/Markdown/" style="font-size: 15px;">Markdown</a> <a href="/tags/%E6%B5%8B%E8%AF%95/" style="font-size: 15px;">测试</a> <a href="/tags/HTTP/" style="font-size: 15px;">HTTP</a> <a href="/tags/IPv6/" style="font-size: 15px;">IPv6</a> <a href="/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 15px;">网络</a> <a href="/tags/SDN/" style="font-size: 15px;">SDN</a> <a href="/tags/mongodb/" style="font-size: 15px;">mongodb</a> <a href="/tags/Mysql/" style="font-size: 15px;">Mysql</a> <a href="/tags/Redis/" style="font-size: 15px;">Redis</a> <a href="/tags/%E7%BC%93%E5%AD%98/" style="font-size: 15px;">缓存</a> <a href="/tags/Jenkins/" style="font-size: 15px;">Jenkins</a> <a href="/tags/%E5%AE%B9%E5%99%A8/" style="font-size: 15px;">容器</a> <a href="/tags/nginx/" style="font-size: 15px;">nginx</a> <a href="/tags/restful/" style="font-size: 15px;">restful</a> <a href="/tags/maven/" style="font-size: 15px;">maven</a> <a href="/tags/CAP/" style="font-size: 15px;">CAP</a> <a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 15px;">前端</a> <a href="/tags/%E8%BF%90%E7%BB%B4/" style="font-size: 15px;">运维</a> <a href="/tags/ideas/" style="font-size: 15px;">ideas</a> <a href="/tags/%E6%8A%80%E6%9C%AF%E5%B0%8F%E6%A0%88/" style="font-size: 15px;">技术小栈</a> <a href="/tags/%E9%AB%98%E5%B9%B6%E5%8F%91/" style="font-size: 15px;">高并发</a> <a href="/tags/%E5%B9%B6%E5%8F%91/" style="font-size: 15px;">并发</a> <a href="/tags/%E6%97%A5%E5%BF%97/" style="font-size: 15px;">日志</a> <a href="/tags/%E8%AF%AD%E5%BD%95/" style="font-size: 15px;">语录</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2023/05/21/%E6%8A%80%E6%9C%AF%E5%B0%8F%E6%A0%88/java%20%E5%90%AF%E5%8A%A8%E5%8F%82%E6%95%B0urandom%E7%9A%84%E4%BD%9C%E7%94%A8/">-Djava.security.egd=file:/dev/./urandom参数的作用</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/04/11/%E6%8A%80%E6%9C%AF%E5%B0%8F%E6%A0%88/G6%E7%9A%84%E8%87%AA%E7%8E%AF%E8%BE%B9%E8%AE%BE%E7%BD%AE-Loop/">G6的自环边设置-Loop</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/04/07/%E6%8A%80%E6%9C%AF%E5%B0%8F%E6%A0%88/%E5%AE%B9%E5%99%A8%E4%B8%ADJava%E5%BA%94%E7%94%A8PID%E4%B8%BA1%E7%9A%84%E9%97%AE%E9%A2%98/">容器中Java应用PID为1的问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/04/06/%E6%8A%80%E6%9C%AF%E5%B0%8F%E6%A0%88/rocketmq%E5%8D%95%E6%9C%BA%E5%91%BD%E4%BB%A4/">rocketmq单机命令</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/04/03/%E8%AF%AD%E5%BD%95/%E6%97%A9%E5%AE%890403/">早安</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/04/02/%E8%AF%AD%E5%BD%95/%E6%97%A9%E5%AE%890402/">早安</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/03/25/%E8%AF%AD%E5%BD%95/%E6%97%A9%E5%AE%890325/">早安</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/03/20/%E8%AF%AD%E5%BD%95/%E5%A6%82%E4%BD%95%E9%80%9A%E8%BF%87%E5%86%99%E8%AE%A1%E5%88%92%EF%BC%8C%E8%B5%A2%E5%BE%97%E5%B7%A5%E4%BD%9C%E6%8E%8C%E6%8E%A7%E6%84%9F/">如何通过写计划，赢得工作掌控感</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/03/10/%E8%AF%AD%E5%BD%95/%E6%97%A9%E5%AE%890310/">早安</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/03/07/%E8%AF%AD%E5%BD%95/%E5%8D%87%E7%BB%B4%20%E4%B8%8D%E7%A1%AE%E5%AE%9A%E6%97%B6%E4%BB%A3%E7%9A%84%E5%86%B3%E7%AD%96%E5%8D%9A%E5%BC%88/">升维 不确定时代的决策博弈 选段</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> 最近评论</i></div><div id="widget-waline-list"></div><script type="text/javascript" id="recent-comment" serverURL="https://comment.aimak.cn" count="5" src="/js/recent-comments.js?v=1.0.0" async="async"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://landscape.cncf.io/" title="CNCF" target="_blank">CNCF</a><ul></ul><a href="https://segmentfault.com/" title="SegmentFault" target="_blank">SegmentFault</a><ul></ul><a href="https://blog.csdn.net/junbaozi/category_11649936_3.html" title="CloudNative" target="_blank">CloudNative</a><ul></ul><a href="https://excalidraw.com/" title="excalidraw" target="_blank">excalidraw</a><ul></ul><a href="https://tudan.blog.csdn.net/?type=lately" title="王坦" target="_blank">王坦</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2023 <a href="/." rel="nofollow">枫哲's文栖小筑.</a> ｜苏ICP备18013756号-1<a rel="nofollow" target="_blank" href="https://beian.miit.gov.cn/"></a><!--a(rel='nofollow', target='_blank', href='https://github.com/tufu9441/maupassant-hexo')  Theme--><!--|  by--><!--a(rel='nofollow', target='_blank', href='https://github.com/pagecho')  Cho.--></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.js"></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0"></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.css"><link rel="stylesheet" type="text/css" href="/css/search.css?v=1.0.0"><script type="text/javascript" src="/js/search.js?v=1.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
  search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/copycode.js?v=1.0.0" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css?v=1.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>